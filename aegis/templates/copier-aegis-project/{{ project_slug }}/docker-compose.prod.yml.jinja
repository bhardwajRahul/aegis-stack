{%- if include_ingress -%}
# Production overrides
# Usage: docker compose -f docker-compose.yml -f docker-compose.prod.yml --profile prod up -d
#
# Key differences from dev:
#   - No code volume mounts (code is baked into the image)
#   - Only essential ports exposed (80, 443)
#   - No debug ports (no dashboard, no direct DB access)

services:
  webserver:
    volumes: []  # Remove dev code mount - code is baked into the image
    profiles:
      - dev
      - prod
{% if include_redis %}
  redis:
    ports: []  # No direct Redis access in production
    profiles:
      - dev
      - prod
{% endif %}
{% if database_type == "postgres" %}
  postgres:
    ports: []  # No direct DB access in production
    profiles:
      - dev
      - prod
{% endif %}
  traefik:
    ports:
      - "80:80"
{%- if ingress_tls %}
      - "443:443"
{%- endif %}
      # No 8080 dashboard port exposed in production
{% endif %}
